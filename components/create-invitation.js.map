{"version":3,"file":"create-invitation.js","sourceRoot":"","sources":["../../src/components/create-invitation.ts"],"names":[],"mappings":"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","sourcesContent":["import { MobxReactionUpdate } from '@adobe/lit-mobx';\nimport {\n  BaseElement,\n  connectDeps,\n  DepsElement,\n} from '@holochain-open-dev/common';\nimport {\n  CreateProfileForm,\n  Dictionary,\n  ProfilePrompt,\n  SearchAgent,\n} from '@holochain-open-dev/profiles';\nimport { html, css, property } from 'lit-element';\nimport { InvitationsStore } from '../invitations.store';\n\nimport { Button } from 'scoped-material-components/mwc-button';\n\nimport { Icon } from '@material/mwc-icon';\nimport { List } from 'scoped-material-components/mwc-list';\nimport { ListItem } from '@material/mwc-list/mwc-list-item';\nimport { Card } from 'scoped-material-components/mwc-card';\n\nimport { CircularProgress } from 'scoped-material-components/mwc-circular-progress';\n\nimport { AgentPubKey } from '../types';\nimport { sharedStyles } from '../shared-styles';\n\nexport abstract class CreateInvitation\n  extends MobxReactionUpdate(BaseElement)\n  implements DepsElement<InvitationsStore>\n{\n  abstract get _deps(): InvitationsStore;\n\n  static styles = [sharedStyles];\n\n  @property({ type: Array })\n  invitees: Dictionary<String> = {};\n\n  _addInvitee(e: CustomEvent) {\n    // console.log(e.detail.agent.profile.nickname);\n\n    this.invitees[e.detail.agent.agent_pub_key] =\n      e.detail.agent.profile.nickname;\n    this.requestUpdate();\n  }\n\n  _removeInvitee(e: Event) {\n    let node: any = e.target;\n    delete this.invitees[node.id];\n    this.requestUpdate();\n  }\n\n  async _sendInvitation() {\n    //this is the input for the create invitation method define in the holochain side\n    let invitees_list: AgentPubKey[] = [];\n\n    Object.entries(this.invitees).map(element => {\n      invitees_list.push(element[0]);\n\n      delete this.invitees[element[0]];\n    });\n    \n    if(invitees_list.length > 0 ){\n      await this._deps.sendInvitation(invitees_list);\n      await this._deps.fetchMyPendingInvitations();\n      this.requestUpdate();\n    }\n    \n  }\n\n  async _pedignInvitations() {\n    await this._deps.fetchMyPendingInvitations();\n  }\n\n  renderInviteesList() {\n    return html`\n      <mwc-list>\n        ${Object.entries(this.invitees).map(element => {\n          return html` <mwc-list-item hasMeta>\n            <span>${element[1]}</span>\n            <mwc-icon\n              slot=\"meta\"\n              id=\"${element[0]}\"\n              @click=\"${this._removeInvitee}\"\n              >close</mwc-icon\n            >\n          </mwc-list-item>`;\n        })}\n      </mwc-list>\n    `;\n  }\n\n  render() {\n    return html`\n      <mwc-card style=\"flex: 1;\">\n        <div class=\"column\" style=\"margin: 16px; flex: 1;\">\n          <span class=\"title\" style=\"margin-bottom: 16px;\"\n            >Create Invitation</span\n          >\n          <search-agent\n            @agent-selected=\"${this._addInvitee}\"\n            clear-on-select\n            style=\"margin-bottom: 16px;\"\n          ></search-agent>\n\n          <div\n            class=\"flex-scrollable-parent\"\n            style=\"flex: 1; margin-bottom: 16px;\"\n          >\n            <div class=\"flex-scrollable-container\">\n              <div class=\"flex-scrollable-y\">${this.renderInviteesList()}</div>\n            </div>\n          </div>\n\n          <mwc-button label=\"Send Invitation\" @click=${this._sendInvitation}>\n            <mwc-icon slot=\"icon\">send</mwc-icon>\n          </mwc-button>\n        </div>\n      </mwc-card>\n    `;\n  }\n\n  getScopedElements() {\n    return {\n      'mwc-circular-progress': CircularProgress,\n      'mwc-icon': Icon,\n      'mwc-list': List,\n      'mwc-card': Card,\n      'mwc-list-item': ListItem,\n      'mwc-button': Button,\n      'search-agent': connectDeps(SearchAgent, this._deps.profilesStore),\n    };\n  }\n}\n"]}