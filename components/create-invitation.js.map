{"version":3,"file":"create-invitation.js","sourceRoot":"","sources":["../../src/components/create-invitation.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, css } from 'lit';\nimport { requestContext } from '@holochain-open-dev/context';\nimport { state, property, query } from 'lit/decorators.js';\nimport { ScopedRegistryHost } from '@lit-labs/scoped-registry-mixin';\nimport { MobxLitElement } from '@adobe/lit-mobx';\n\n/**mwc-elements imports */\nimport { Card } from 'scoped-material-components/mwc-card';\nimport { List } from 'scoped-material-components/mwc-list';\nimport { Icon } from 'scoped-material-components/mwc-icon';\nimport { Button } from 'scoped-material-components/mwc-button';\nimport { ListItem } from 'scoped-material-components/mwc-list-item';\nimport { Snackbar } from 'scoped-material-components/mwc-snackbar';\n\nimport {\n  Dictionary,\n  ProfilePrompt,\n  SearchAgent,\n} from '@holochain-open-dev/profiles';\n\nimport { InvitationsStore } from '../invitations.store';\n\n\n\nimport { INVITATIONS_STORE_CONTEXT, AgentPubKey } from '../types';\n\n/**\n * @element create-invitation-form\n */\nexport class CreateInvitation extends ScopedRegistryHost(MobxLitElement) {\n  @requestContext(INVITATIONS_STORE_CONTEXT)\n  _store!: InvitationsStore;\n\n  @state()\n  invitees: Dictionary<string> = {};\n\n  @property({ type: Number })\n  max_invitees = 1;\n\n  @query('#snackbar')\n  snackbar: any;\n\n  static styles = [css`\n    .secondary-text {\n      color: rgba(0, 0, 0, 0.54);\n    }\n  `];\n\n  _addInvitee(e: CustomEvent) {\n\n    if (Object.values(this.invitees).length < this.max_invitees) {\n\n      console.log(e.detail.agent.profile.nickname);\n      this.invitees[e.detail.agent.agent_pub_key] =\n        e.detail.agent.profile.nickname;\n      this.requestUpdate();\n    } else {\n      this.snackbar.show();\n    }\n\n  }\n  _removeInvitee(e: Event) {\n    const node: any = e.target;\n    delete this.invitees[node.id];\n    this.requestUpdate();\n  }\n  async _sendInvitation() {\n    //this is the input for the create invitation method define in the holochain side\n    const invitees_list: AgentPubKey[] = [];\n\n    Object.entries(this.invitees).map(element => {\n      invitees_list.push(element[0]);\n      delete this.invitees[element[0]];\n    });\n\n    if (invitees_list.length > 0) {\n      await this._store.sendInvitation(invitees_list);\n      await this._store.fetchMyPendingInvitations();\n      this.requestUpdate();\n    }\n  }\n  async _pedignInvitations() {\n    await this._store.fetchMyPendingInvitations();\n  }\n  renderInviteesList() {\n\n    const invitees = Object.entries(this.invitees);\n\n    return html`\n      <mwc-list>\n        ${invitees.map(element => {\n\n      const invitee_nickname = element[1];\n\n      return html` <mwc-list-item hasMeta>\n            <span>${invitee_nickname}</span>\n            <mwc-icon\n              slot=\"meta\"\n              id=\"${element[0]}\"\n              @click=\"${this._removeInvitee}\"\n              >close</mwc-icon\n            >\n          </mwc-list-item>`;\n    })}\n      </mwc-list>\n    `;\n  }\n  render() {\n    return html`\n      <mwc-card style=\"flex: 1;\">\n        <div class=\"column\" style=\"margin: 16px; flex: 1;\">\n          \n        <div style =\"display: flex; justify-content:center;\"> \n          <span class=\"title\" style=\"margin-bottom: 16px;\">\n            Create Invitation\n          </span>\n        </div>\n\n          \n\n          <search-agent\n            @agent-selected=\"${this._addInvitee}\"\n            clear-on-select\n            style=\"margin-bottom: 16px;\"\n          ></search-agent>\n\n          <div\n            class=\"flex-scrollable-parent\"\n            style=\"flex: 1; margin-bottom: 16px;\"\n          >\n            <div class=\"flex-scrollable-container\">\n              <div class=\"flex-scrollable-y\">${this.renderInviteesList()}</div>\n            </div>\n          </div>\n\n          <div style =\"display: flex; justify-content:center;\"> \n          \n            <span class=\"secondary-text\">${Object.values(this.invitees).length}/${this.max_invitees}</span>\n          \n          </div>\n\n          <div style =\"display: flex; justify-content:center;\"> \n            <mwc-button label=\"Send Invitation\" @click=${this._sendInvitation}>\n              <mwc-icon slot=\"icon\">send</mwc-icon>\n            </mwc-button>\n          </div>\n\n\n        </div>\n\n        <mwc-snackbar id=\"snackbar\"\n          labelText=\"Can't add more invitees.\">\n        </mwc-snackbar>\n\n\n\n      </mwc-card>\n    `;\n  }\n\n  static elementDefinitions = {\n    'search-agent': SearchAgent,\n    'profile-prompt': ProfilePrompt,\n    'mwc-icon': Icon,\n    'mwc-list': List,\n    'mwc-card': Card,\n    'mwc-list-item': ListItem,\n    'mwc-button': Button,\n    'mwc-snackbar': Snackbar,\n  };\n}"]}